<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>我的公众号</title>
  <style>
    body { font-family: -apple-system, sans-serif; padding: 15px; background: #f5f5f7; }
    .article { background: white; margin: 10px 0; padding: 12px; border-radius: 10px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
    .title { font-size: 18px; color: #000; text-decoration: none; }
    .title:hover { color: #0078d4; text-decoration: underline; }
    .source { font-size: 12px; color: #888; margin-top: 4px; }
    .date { font-size: 11px; color: #aaa; }
    .error { color: red; margin: 10px 0; padding: 10px; background: #fff0f0; border-radius: 5px; }
    .status { font-size: 14px; color: #666; margin: 10px 0; }
    .refresh-btn { background: #0078d4; color: white; border: none; padding: 8px 16px; border-radius: 5px; cursor: pointer; margin-top: 10px; }
    .refresh-btn:hover { background: #005a9e; }
  </style>
</head>
<body>
  <h1>未读公众号文章</h1>
  <div id="status" class="status">加载中...</div>
  <div id="error" class="error" style="display: none;"></div>
  <div id="articles"></div>
  <button id="refreshBtn" class="refresh-btn">刷新内容</button>

  <script>
    // 👇 在这里填写你要监控的公众号 ID（从 er.shi.ci.mi 获取）
    const wechatIds = [
      'hr_tech',
      'hr_recruitment'
    ];

    // 公众号文章数据
    const articlesData = [
      // HR科技 (hr_tech) 公众号内容
      {
        title: "2024年人力资源数字化转型趋势报告",
        link: "#",
        date: new Date().toLocaleString('zh-CN'),
        source: "hr_tech"
      },
      {
        title: "AI如何重塑企业招聘流程与人才管理",
        link: "#",
        date: new Date(Date.now() - 86400000).toLocaleString('zh-CN'),
        source: "hr_tech"
      },
      {
        title: "远程办公环境下的团队文化建设策略",
        link: "#",
        date: new Date(Date.now() - 172800000).toLocaleString('zh-CN'),
        source: "hr_tech"
      },
      // HR招聘 (hr_recruitment) 公众号内容
      {
        title: "如何有效吸引和留住高潜力人才",
        link: "#",
        date: new Date(Date.now() - 43200000).toLocaleString('zh-CN'),
        source: "hr_recruitment"
      },
      {
        title: "招聘面试中的STAR法则应用指南",
        link: "#",
        date: new Date(Date.now() - 216000000).toLocaleString('zh-CN'),
        source: "hr_recruitment"
      },
      {
        title: "构建多元化招聘渠道的最佳实践",
        link: "#",
        date: new Date(Date.now() - 288000000).toLocaleString('zh-CN'),
        source: "hr_recruitment"
      }
    ];

    function getArticles() {
      // 获取公众号文章数据
      console.log('获取公众号文章数据');
      
      // 深拷贝数据，避免引用问题
      const articles = JSON.parse(JSON.stringify(articlesData));
      
      // 更新文章日期为相对时间
      articles.forEach(article => {
        if (article.source === 'yujiantouzi') {
          // 郁见投资公众号的文章日期
          const days = Math.floor(Math.random() * 5);
          article.date = new Date(Date.now() - days * 86400000).toLocaleString('zh-CN');
        } else if (article.source === 'ticaiyanjiushi') {
          // 题材研究所公众号的文章日期
          const days = Math.floor(Math.random() * 7);
          article.date = new Date(Date.now() - days * 86400000).toLocaleString('zh-CN');
        }
      });
      
      return articles;
    }

    function displayArticles() {
      try {
        document.getElementById('status').textContent = '正在加载文章...';
        document.getElementById('error').style.display = 'none';
        
        // 获取文章数据（这里使用模拟数据）
        const articles = getArticles();
        
        // 按时间倒序排序
        articles.sort((a, b) => new Date(b.date) - new Date(a.date));
        
        // 清空容器并显示文章
        const container = document.getElementById('articles');
        container.innerHTML = '';
        
        articles.forEach(a => {
          const div = document.createElement('div');
          div.className = 'article';
          
          // 根据公众号来源添加不同的样式标识
          const sourceColor = a.source === 'yujiantouzi' ? '#1a73e8' : '#34a853';
          div.innerHTML = `
            <a class="title" href="${a.link}" target="_blank">${a.title}</a>
            <div class="source" style="color: ${sourceColor};">
              来源：${a.source === 'yujiantouzi' ? '郁见投资' : '题材研究所'}
            </div>
            <div class="date">${a.date}</div>
          `;
          container.appendChild(div);
        });
        
        document.getElementById('status').textContent = `共显示 ${articles.length} 篇文章（郁见投资 & 题材研究所）`;
        
      } catch (e) {
        console.error('显示文章时出错:', e);
        document.getElementById('error').textContent = `显示错误: ${e.message}`;
        document.getElementById('error').style.display = 'block';
        document.getElementById('status').textContent = '加载失败';
      }
    }

    // 添加刷新按钮功能
    document.getElementById('refreshBtn').addEventListener('click', function() {
      this.disabled = true;
      this.textContent = '刷新中...';
      
      // 重新加载文章
      displayArticles();
      
      // 恢复按钮状态
      setTimeout(() => {
        this.disabled = false;
        this.textContent = '刷新内容';
      }, 1000);
    });

    // 添加错误处理
    window.onerror = function(message, source, lineno, colno, error) {
      console.error('全局错误:', message, error);
      document.getElementById('error').textContent = `JavaScript错误: ${message}`;
      document.getElementById('error').style.display = 'block';
      return true;
    };

    // 页面加载时显示文章
    displayArticles();
  </script>
</body>
</html>
